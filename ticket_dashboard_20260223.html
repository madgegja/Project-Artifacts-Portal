<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Toomics CS â€” Ticket Dashboard</title>
<style>
:root {
  --bg: #f8fafc; --bg2: #ffffff; --bg3: #f1f5f9;
  --text: #1e293b; --text2: #475569; --muted: #94a3b8;
  --blue: #2563eb; --cyan: #0891b2; --green: #059669;
  --amber: #d97706; --red: #dc2626; --purple: #7c3aed;
  --border: #e2e8f0; --border2: rgba(0,0,0,0.04);
  --radius: 12px; --sidebar-w: 500px;
  --shadow: 0 1px 3px rgba(0,0,0,0.08);
  --shadow2: 0 4px 12px rgba(0,0,0,0.06);
}
* { margin:0; padding:0; box-sizing:border-box; }
body {
  font-family: 'Malgun Gothic','Apple SD Gothic Neo','Noto Sans KR',-apple-system,sans-serif;
  background: var(--bg); color: var(--text);
  font-size: 13px; line-height: 1.5;
  height: 100vh; overflow: hidden;
  display: flex; flex-direction: column;
}

/* â”€â”€ Top Bar â”€â”€ */
.topbar {
  background: #ffffff;
  border-bottom: 1px solid var(--border);
  padding: 14px 24px; display: flex; align-items: center;
  gap: 16px; flex-shrink: 0; position: relative;
  box-shadow: var(--shadow);
}
.topbar-logo { font-size:18px; font-weight:800; letter-spacing:-0.3px; color:var(--text); position:relative; }
.topbar-logo span { color: var(--blue); }
.topbar-sub { font-size: 12px; color:var(--muted); position:relative; margin-top:1px; }
.topbar-right { margin-left:auto; display:flex; align-items:center; gap:10px; position:relative; }
.auto-refresh-badge {
  font-size: 12px; padding:3px 10px; border-radius:20px;
  background:#ecfdf5; color:#059669;
  border:1px solid #a7f3d0; cursor:pointer;
  user-select:none; transition: all .2s;
}
.auto-refresh-badge.paused { background:#f8fafc; color:var(--muted); border-color:var(--border); }
.refresh-btn {
  background: #eff6ff; border:1px solid #bfdbfe;
  color: var(--blue); padding:5px 12px; border-radius:8px; cursor:pointer;
  font-size:12px; font-weight:700; transition: all .2s;
}
.refresh-btn:hover { background: #dbeafe; }
.last-updated { font-size: 12px; color:var(--muted); }

/* â”€â”€ KPI Bar â”€â”€ */
.kpi-bar {
  background: #ffffff; border-bottom:1px solid var(--border);
  padding: 14px 24px; display:flex; gap:14px; flex-shrink:0; overflow-x:auto;
}
.kpi-card {
  background: #ffffff; border:1px solid var(--border);
  border-radius: 10px; padding:14px 20px; min-width:135px;
  cursor:pointer; transition: all .2s; position:relative; overflow:hidden;
  border-top: 3px solid transparent; box-shadow: var(--shadow);
}
.kpi-card:hover { border-color: var(--blue); transform: translateY(-2px); box-shadow: var(--shadow2); }
.kpi-card.active { border-color: var(--blue) !important; background: #eff6ff; }
.kpi-card .k-val { font-size:28px; font-weight:800; line-height:1.1; }
.kpi-card .k-lbl { font-size: 12px; color:var(--text2); margin-top:4px; font-weight:600; }
.kpi-card.k-new { border-top-color: var(--cyan); } .kpi-card.k-new .k-val { color:var(--cyan); }
.kpi-card.k-open { border-top-color: var(--blue); } .kpi-card.k-open .k-val { color:var(--blue); }
.kpi-card.k-pending { border-top-color: var(--amber); } .kpi-card.k-pending .k-val { color:var(--amber); }
.kpi-card.k-solved { border-top-color: var(--green); } .kpi-card.k-solved .k-val { color:var(--green); }
.kpi-card.k-l1 { border-top-color: var(--red); } .kpi-card.k-l1 .k-val { color:var(--red); }

/* â”€â”€ Filter Bar â”€â”€ */
.filter-bar {
  background: #ffffff; border-bottom:1px solid var(--border);
  padding: 10px 24px; display:flex; gap:10px; align-items:center; flex-shrink:0; flex-wrap:wrap;
}
.filter-bar input[type=text] {
  background: #f8fafc; border:1px solid var(--border); color:var(--text);
  padding:7px 12px; border-radius:8px; font-size:12px; width:220px; outline:none;
  transition: border-color .2s;
}
.filter-bar input[type=text]:focus { border-color:var(--blue); box-shadow: 0 0 0 3px rgba(37,99,235,0.1); }
.filter-bar input[type=text]::placeholder { color:var(--muted); }
select.flt {
  background: #f8fafc; border:1px solid var(--border); color:var(--text);
  padding:6px 10px; border-radius:8px; font-size:12px; outline:none; cursor:pointer;
}
select.flt:focus { border-color: var(--blue); box-shadow: 0 0 0 3px rgba(37,99,235,0.1); }
.filter-sep { width:1px; height:20px; background:var(--border); }
.clear-btn {
  background:#fff; border:1px solid var(--border); color:var(--text2);
  padding:6px 12px; border-radius:8px; cursor:pointer; font-size: 12px; font-weight:600; transition:all .2s;
}
.clear-btn:hover { border-color:var(--red); color:var(--red); background:#fef2f2; }
.result-count { font-size: 12px; color:var(--muted); margin-left:auto; }

/* â”€â”€ Main Layout â”€â”€ */
.main { display:flex; flex:1; overflow:hidden; }

/* â”€â”€ Ticket List â”€â”€ */
.ticket-list-pane {
  flex:1; overflow-y:auto; min-width:0;
}
.ticket-list-pane::-webkit-scrollbar { width:6px; }
.ticket-list-pane::-webkit-scrollbar-thumb { background:var(--border); border-radius:3px; }

.ticket-row {
  display:grid;
  grid-template-columns: 70px 1fr 60px 50px 64px 80px 76px 145px 36px;
  gap:0; align-items:center;
  padding:10px 16px; border-bottom:1px solid var(--border2);
  cursor:pointer; transition:background .15s; min-height:52px;
}
.ticket-row:hover { background: #f1f5f9; }
.ticket-row.active { background: #eff6ff; box-shadow: inset 3px 0 0 var(--blue); }
.ticket-row.tr-l1 { box-shadow: inset 3px 0 0 var(--red); }
.ticket-row.tr-l2 { box-shadow: inset 3px 0 0 var(--amber); }
.ticket-row.tr-l3 { box-shadow: inset 3px 0 0 var(--green); }
.ticket-row.active.tr-l1 { box-shadow: inset 3px 0 0 var(--red), inset 0 0 0 1px rgba(37,99,235,0.2); background:#eff6ff; }
.ticket-row.active.tr-l2 { box-shadow: inset 3px 0 0 var(--amber), inset 0 0 0 1px rgba(37,99,235,0.2); background:#eff6ff; }
.ticket-row.active.tr-l3 { box-shadow: inset 3px 0 0 var(--green), inset 0 0 0 1px rgba(37,99,235,0.2); background:#eff6ff; }
.t-lang { font-size:13px; text-align:center; }
.t-sortable { cursor:pointer; user-select:none; }
.t-sortable:hover { color:var(--blue); }

.thead {
  background: #f8fafc; position:sticky; top:0; z-index:10;
  border-bottom:2px solid var(--border); font-size: 12px;
  color:var(--text2); font-weight:700; text-transform:uppercase; letter-spacing:.5px;
}
.thead .ticket-row { min-height:36px; }
.thead .ticket-row:hover { background:transparent; cursor:default; }

.t-id { font-size: 12px; font-weight:700; color:var(--blue); font-family:monospace; }
.t-subject { overflow:hidden; }
.t-subject .subj { font-weight:600; color:var(--text); font-size:13px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.t-subject .desc { font-size: 12px; color:var(--text2); white-space:nowrap; overflow:hidden; text-overflow:ellipsis; margin-top:2px; }
.t-channel { font-size: 12px; color:var(--text2); }
.t-level .badge, .t-cat .badge, .t-status .badge {
  display:inline-block; padding:2px 8px; border-radius:8px;
  font-size: 12px; font-weight:700;
}
.badge-l1 { background:#fef2f2; color:#dc2626; border:1px solid #fecaca; }
.badge-l2 { background:#fffbeb; color:#d97706; border:1px solid #fde68a; }
.badge-l3 { background:#ecfdf5; color:#059669; border:1px solid #a7f3d0; }
.badge-dash { color:var(--muted); }
.badge-new { background:#ecfeff; color:#0891b2; border:1px solid #a5f3fc; }
.badge-open { background:#eff6ff; color:#2563eb; border:1px solid #bfdbfe; }
.badge-pending { background:#fffbeb; color:#d97706; border:1px solid #fde68a; }
.badge-solved { background:#ecfdf5; color:#059669; border:1px solid #a7f3d0; }
.t-date { font-size:12px; color:var(--text); font-weight:600; font-variant-numeric:tabular-nums; }
.t-open-btn { background:transparent; border:none; color:var(--muted); cursor:pointer; font-size:14px; padding:4px; border-radius:6px; transition:all .2s; }
.t-open-btn:hover { background:#eff6ff; color:var(--blue); }

/* â”€â”€ Empty/Loading â”€â”€ */
.empty-state, .loading-state {
  text-align:center; padding:60px 40px; color:var(--muted);
}
.loading-state { color:var(--text2); }
.loading-state .spinner {
  width:32px; height:32px; border:3px solid var(--border);
  border-top-color:var(--blue); border-radius:50%;
  animation: spin .7s linear infinite; margin:0 auto 16px;
}
@keyframes spin { to { transform:rotate(360deg); } }

/* â”€â”€ Pagination â”€â”€ */
.pagination { display:flex; align-items:center; justify-content:center; gap:8px; padding:12px; border-top:1px solid var(--border); }
.page-btn {
  background:#fff; border:1px solid var(--border); color:var(--text2);
  padding:5px 12px; border-radius:8px; cursor:pointer; font-size:12px; transition:all .2s;
}
.page-btn:hover { border-color:var(--blue); color:var(--blue); background:#eff6ff; }
.page-btn:disabled { opacity:.4; cursor:default; }
.page-btn.current { background:#eff6ff; border-color:var(--blue); color:var(--blue); font-weight:700; }
.page-info { font-size:12px; color:var(--muted); }

/* â”€â”€ Sidebar Detail â”€â”€ */
.detail-sidebar {
  width: var(--sidebar-w); background:#ffffff; border-left:1px solid var(--border);
  display:flex; flex-direction:column; overflow:hidden;
  transform: translateX(100%); transition: transform .3s cubic-bezier(.4,0,.2,1);
  position:relative; flex-shrink:0;
}
.detail-sidebar.open { transform: translateX(0); }

.detail-header {
  padding:16px 20px; border-bottom:1px solid var(--border);
  display:flex; align-items:flex-start; gap:12px; flex-shrink:0;
}
.detail-header .dh-title { flex:1; min-width:0; }
.detail-header .dh-id { font-size:12px; font-weight:700; color:var(--blue); font-family:monospace; margin-bottom:4px; }
.detail-header .dh-subject { font-size:15px; font-weight:700; color:var(--text); line-height:1.4; }
.detail-close { background:transparent; border:none; color:var(--muted); cursor:pointer; font-size:18px; padding:2px; flex-shrink:0; }
.detail-close:hover { color:var(--text); }

.detail-meta {
  padding:12px 20px; border-bottom:1px solid var(--border);
  display:flex; flex-wrap:wrap; gap:8px; flex-shrink:0;
}
.meta-chip {
  font-size: 12px; padding:4px 10px; border-radius:8px;
  background:#f8fafc; border:1px solid var(--border); color:var(--text2);
  display:flex; align-items:center; gap:4px; font-weight:500;
}
.meta-chip .label { color:var(--muted); font-size: 12px; font-weight:600; }

.detail-body { flex:1; overflow-y:auto; padding:16px 20px; }
.detail-body::-webkit-scrollbar { width:5px; }
.detail-body::-webkit-scrollbar-thumb { background:var(--border); border-radius:3px; }

.detail-actions {
  padding:12px 20px; border-top:1px solid var(--border);
  display:flex; gap:8px; flex-shrink:0;
}
.action-btn {
  flex:1; padding:8px; border-radius:8px; font-size:12px; font-weight:700;
  cursor:pointer; border:none; transition:all .2s; text-align:center; text-decoration:none;
  display:flex; align-items:center; justify-content:center; gap:6px;
}
.action-btn.primary { background: var(--blue); color:#fff; }
.action-btn.primary:hover { background: #1d4ed8; }
.action-btn.secondary { background:#f8fafc; color:var(--text2); border:1px solid var(--border); }
.action-btn.secondary:hover { border-color:var(--blue); color:var(--blue); background:#eff6ff; }

/* â”€â”€ Comment â”€â”€ */
.comment-thread { display:flex; flex-direction:column; gap:12px; }
.comment-item { border-radius:10px; overflow:hidden; }
.comment-item.customer { background: #eff6ff; border:1px solid #bfdbfe; margin-right:32px; }
.comment-item.bot { background: #ecfdf5; border:1px solid #a7f3d0; margin-left:32px; }
.comment-item.internal { background: #fffbeb; border:1px solid #fde68a; margin-left:32px; font-size: 12px; }
.comment-item.fraud { background: #fef2f2; border:1px solid #fca5a5; margin-left:32px; font-size: 12px; }
.comment-item.fraud .c-author { color:#dc2626; }
.c-fraud { background:#fecaca; color:#991b1b; }
.comment-meta {
  padding:7px 12px; display:flex; align-items:center; gap:8px; font-size: 12px;
  border-bottom:1px solid rgba(0,0,0,.06);
}
.comment-meta .c-author { font-weight:700; color:var(--text); }
.comment-meta .c-time { color:var(--muted); margin-left:auto; font-size: 12px; }
.comment-meta .c-badge { font-size: 12px; padding:1px 6px; border-radius:6px; }
.c-cust { background:#dbeafe; color:#1d4ed8; }
.c-bot { background:#d1fae5; color:#047857; }
.c-int { background:#fef3c7; color:#b45309; }
.comment-body { padding:10px 12px; font-size:13px; color:var(--text); line-height:1.7; white-space:pre-wrap; word-break:break-word; max-height:250px; overflow-y:auto; }

/* â”€â”€ Loading overlay for sidebar â”€â”€ */
.sidebar-loading { text-align:center; padding:40px; color:var(--muted); }
.sidebar-loading { color:var(--text2); }
.sidebar-loading .spinner { width:28px; height:28px; border:3px solid var(--border); border-top-color:var(--blue); border-radius:50%; animation:spin .7s linear infinite; margin:0 auto 12px; }

/* â”€â”€ Error banner â”€â”€ */
.error-banner { background:#fef2f2; border:1px solid #fecaca; color:#dc2626; border-radius:8px; padding:10px 14px; margin:8px 16px; font-size:12px; }

/* â”€â”€ Scrollbar global â”€â”€ */
@media (max-width:1200px) {
  .detail-sidebar { position:absolute; right:0; top:0; bottom:0; z-index:100; box-shadow:-4px 0 20px rgba(0,0,0,0.12); }
  .detail-sidebar.open { transform:translateX(0); }
}
.demo-banner {
  position:fixed; bottom:12px; left:12px; z-index:999;
  background:#fffbeb; border:1px solid #fde68a; color:#92400e;
  padding:6px 14px; border-radius:8px; font-size: 12px; font-weight:600;
  box-shadow: var(--shadow2);
}
::-webkit-scrollbar { width:6px; height:6px; }
::-webkit-scrollbar-track { background:#f8fafc; }
::-webkit-scrollbar-thumb { background:#cbd5e1; border-radius:3px; }
::-webkit-scrollbar-thumb:hover { background:#94a3b8; }
</style>
</head>
<body>

<!-- â”€â”€ Top Bar â”€â”€ -->
<div class="topbar">
  <div>
    <div class="topbar-logo">Toomics <span>CS</span> Dashboard</div>
    <div class="topbar-sub">ì±—ë´‡ ì²˜ë¦¬ í‹°ì¼“ Â· ì´ë©”ì¼ ì œì™¸ Â· ì‹¤ì‹œê°„ ì¡°íšŒ</div>
  </div>
  <div class="topbar-right">
    <span class="last-updated" id="lastUpdated">â€“</span>
    <span class="auto-refresh-badge" id="arBadge" onclick="toggleAutoRefresh()">ğŸ”„ ìë™ê°±ì‹  ON</span>
    <button class="refresh-btn" onclick="loadAll()">â†» ìƒˆë¡œê³ ì¹¨</button>
  </div>
</div>

<!-- â”€â”€ KPI Bar â”€â”€ -->
<div class="kpi-bar" id="kpiBar">
  <div class="kpi-card k-new active" onclick="setStatusFilter('new')" data-s="new">
    <div class="k-val" id="kv-new">â€“</div><div class="k-lbl">ğŸ†• New</div>
  </div>
  <div class="kpi-card k-open" onclick="setStatusFilter('open')" data-s="open">
    <div class="k-val" id="kv-open">â€“</div><div class="k-lbl">ğŸ”µ Open</div>
  </div>
  <div class="kpi-card k-pending" onclick="setStatusFilter('pending')" data-s="pending">
    <div class="k-val" id="kv-pending">â€“</div><div class="k-lbl">ğŸŸ¡ Pending</div>
  </div>
  <div class="kpi-card k-solved" onclick="setStatusFilter('solved')" data-s="solved">
    <div class="k-val" id="kv-solved">â€“</div><div class="k-lbl">âœ… Solved</div>
  </div>
  <div class="kpi-card k-l1" onclick="setLevelFilter('L1')" data-s="l1">
    <div class="k-val" id="kv-l1">â€“</div><div class="k-lbl">ğŸ”´ L1 ê¸´ê¸‰ (Open)</div>
  </div>
</div>

<!-- â”€â”€ Filter Bar â”€â”€ -->
<div class="filter-bar">
  <input type="text" id="searchInput" placeholder="ğŸ”  í‹°ì¼“ #, ì œëª©, ì´ë©”ì¼ ê²€ìƒ‰..." oninput="debounceSearch()" />
  <div class="filter-sep"></div>
  <select class="flt" id="statusFilter" onchange="applyFilters()">
    <option value="">ëª¨ë“  ìƒíƒœ</option>
    <option value="new">New</option>
    <option value="open">Open</option>
    <option value="pending">Pending</option>
    <option value="solved">Solved</option>
  </select>
  <select class="flt" id="channelFilter" onchange="applyFilters()">
    <option value="">ëª¨ë“  ì±„ë„</option>
    <option value="api">ì±—ë´‡</option>
    <option value="web">ì›¹</option>
    <option value="chat">ì±„íŒ…</option>
  </select>
  <select class="flt" id="levelFilter" onchange="applyFilters()">
    <option value="">ëª¨ë“  ë ˆë²¨</option>
    <option value="L1">L1 ê¸´ê¸‰</option>
    <option value="L2">L2 ê²€í† </option>
    <option value="L3">L3 ìë™</option>
  </select>
  <select class="flt" id="languageFilter" onchange="applyFilters()">
    <option value="">ëª¨ë“  ì–¸ì–´</option>
    <option value="en">ğŸ‡ºğŸ‡¸ EN</option>
    <option value="fr">ğŸ‡«ğŸ‡· FR</option>
    <option value="es">ğŸ‡ªğŸ‡¸ ES</option>
    <option value="pt">ğŸ‡§ğŸ‡· PT</option>
    <option value="de">ğŸ‡©ğŸ‡ª DE</option>
    <option value="th">ğŸ‡¹ğŸ‡­ TH</option>
    <option value="jp">ğŸ‡¯ğŸ‡µ JP</option>
    <option value="cn">ğŸ‡¨ğŸ‡³ CN</option>
    <option value="it">ğŸ‡®ğŸ‡¹ IT</option>
  </select>
  <select class="flt" id="categoryFilter" onchange="applyFilters()">
    <option value="">ëª¨ë“  ì¹´í…Œê³ ë¦¬</option>
    <option value="Subscription">Subscription</option>
    <option value="Refund">Refund</option>
    <option value="Account">Account</option>
    <option value="Payment">Payment</option>
    <option value="Content">Content</option>
    <option value="Technical">Technical</option>
    <option value="Fraud">Fraud</option>
  </select>
  <button class="clear-btn" onclick="clearFilters()">âœ• ì´ˆê¸°í™”</button>
  <span class="result-count" id="resultCount"></span>
</div>

<!-- â”€â”€ Main â”€â”€ -->
<div class="main">
  <!-- Ticket List -->
  <div class="ticket-list-pane" id="ticketListPane">
    <!-- thead -->
    <div class="thead">
      <div class="ticket-row">
        <span class="t-id">ID</span>
        <span class="t-subject">ì œëª©</span>
        <span class="t-channel">ì±„ë„</span>
        <span class="t-lang">ì–¸ì–´</span>
        <span class="t-level">ë ˆë²¨</span>
        <span class="t-cat">ì¹´í…Œê³ ë¦¬</span>
        <span class="t-status">ìƒíƒœ</span>
        <span class="t-date t-sortable" onclick="toggleSort('date')" title="ì •ë ¬">ì ‘ìˆ˜ì¼ <span id="sortIcon">â–¼</span></span>
        <span></span>
      </div>
    </div>
    <!-- body -->
    <div id="ticketBody">
      <div class="loading-state"><div class="spinner"></div>í‹°ì¼“ ë¡œë”© ì¤‘...</div>
    </div>
    <div id="paginationBar" class="pagination" style="display:none;"></div>
  </div>

  <!-- Detail Sidebar -->
  <div class="detail-sidebar" id="detailSidebar">
    <div id="detailContent">
      <div class="sidebar-loading"><div class="spinner"></div>ë¡œë”© ì¤‘...</div>
    </div>
    <div class="detail-actions" id="detailActions" style="display:none;">
      <a class="action-btn primary" id="zendeskLink" href="#" target="_blank">ğŸ”— Zendeskì—ì„œ ì—´ê¸°</a>
      <button class="action-btn secondary" onclick="closeSidebar()">âœ• ë‹«ê¸°</button>
    </div>
  </div>
</div>

<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// DEMO MODE â€” API ì—†ì´ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¡œ ë™ì‘
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const DEMO_MODE = (location.protocol === 'file:' || location.hostname.includes('github.io') || !location.port);

const MOCK_TICKETS = [
  // â”€â”€ Subscription (48%) â”€â”€ 12 tickets â”€â”€
  // L3: cancel_subscription (EN) â€” ì…€í”„ì„œë¹„ìŠ¤ ìë™ í•´ì§€
  {id:125501, subject:"I want to cancel my VIP subscription", description:"I signed up for the monthly plan 2 weeks ago. I don't want to continue. Please cancel and stop all future charges.", status:"solved", priority:"normal", channel:"ì±—ë´‡", level:"L3", category:"Subscription", tags:["l3","subscription","cancel_subscription","self_service","language__en","sentiment__neutral"], created_at:"2026-02-23 09:14", updated_at:"2026-02-23 09:15",
   comments:[
     {id:1,body:"I want to cancel my VIP subscription immediately. I signed up for the monthly plan 2 weeks ago but I don't want to continue. Please stop all future charges.",author_id:38001,public:true,created_at:"2026-02-23 09:14"},
     {id:2,body:"We understand you'd like to cancel your subscription. Here's how you can do it:\n\n1. Log in to your account at en.toomics.com\n2. Go to My Page â†’ Subscription Management\n3. Click 'Cancel Subscription'\n4. Confirm the cancellation\n\nYour VIP access will remain active until the end of your current billing period. No further charges will be made.\n\nIf you need any further assistance, feel free to submit a support ticket.\n\nBest regards,\nToomics Support Team",author_id:39001,public:true,created_at:"2026-02-23 09:15"},
     {id:3,body:"[BOT] Intent: cancel_subscription (confidence: 0.97)\nLevel: L3 â€” Self-service flow triggered\nMarket: EN | Sentiment: neutral\nFlow: cancel_subscription > web platform guide\nResolution: Auto-resolved",author_id:39001,public:false,created_at:"2026-02-23 09:15"}
   ]},
  // L2: cancel_and_refund (EN) â€” í•´ì§€+í™˜ë¶ˆ ë™ì‹œ
  {id:125502, subject:"Cancel subscription and refund request", description:"I cancelled 2 days ago but was charged $9.99 again today on my Visa.", status:"pending", priority:"high", channel:"ì±—ë´‡", level:"L2", category:"Subscription", tags:["l2","subscription","cancel_and_refund","charged_after_cancel","language__en","sentiment__frustrated"], created_at:"2026-02-23 04:10", updated_at:"2026-02-23 06:30",
   comments:[
     {id:4,body:"I cancelled my subscription 2 days ago but I was charged $9.99 again today on my Visa ending in 4832. I want a full refund for this unauthorized charge. I already cancelled!",author_id:38002,public:true,created_at:"2026-02-23 04:10"},
     {id:5,body:"We're sorry to hear about this unexpected charge. It appears the cancellation may not have processed before your billing cycle date.\n\nWe've escalated your case to our billing team for review. They will verify the cancellation timing and process a refund if applicable. You should hear back within 24-48 hours.\n\nBest regards,\nToomics Support Team",author_id:39001,public:true,created_at:"2026-02-23 04:11"},
     {id:6,body:"[BOT] Intent: cancel_and_refund (confidence: 0.94)\nLevel: L2 â€” Escalated to billing team\nMarket: EN | Sentiment: frustrated\nReason: Charged after cancel claim. Billing cycle verification needed.\nCard: Visa ****4832 | Amount: $9.99",author_id:39001,public:false,created_at:"2026-02-23 04:11"}
   ]},
  // L2: auto_renewal_complaint (FR) â€” ìë™ê°±ì‹  ë¯¸ì¸ì§€
  {id:125503, subject:"FacturÃ© sans mon accord â€” renouvellement automatique", description:"Je n'ai jamais acceptÃ© un renouvellement automatique. J'exige un remboursement immÃ©diat de 9,99â‚¬.", status:"open", priority:"high", channel:"ì±—ë´‡", level:"L2", category:"Subscription", tags:["l2","subscription","auto_renewal_complaint","language__fr","sentiment__angry"], created_at:"2026-02-23 10:22", updated_at:"2026-02-23 10:35",
   comments:[
     {id:7,body:"Je viens de voir un prÃ©lÃ¨vement de 9,99â‚¬ sur ma carte. Je n'ai jamais acceptÃ© de renouvellement automatique ! C'est honteux. Je veux un remboursement immÃ©diat. Si ce n'est pas fait dans 48h, je contacterai ma banque.",author_id:38003,public:true,created_at:"2026-02-23 10:22"},
     {id:8,body:"Nous comprenons votre frustration et nous en sommes dÃ©solÃ©s.\n\nLes abonnements Toomics incluent un renouvellement automatique, mentionnÃ© lors de l'inscription. Cependant, nous avons transmis votre demande de remboursement Ã  notre Ã©quipe de facturation pour examen.\n\nVous recevrez une rÃ©ponse dans un dÃ©lai de 24-48 heures.\n\nCordialement,\nL'Ã©quipe Support Toomics",author_id:39001,public:true,created_at:"2026-02-23 10:23"},
     {id:9,body:"[BOT] Intent: auto_renewal_complaint (confidence: 0.96)\nLevel: L2 â€” Escalated (refund review)\nMarket: FR | Sentiment: angry\nâš ï¸ Chargeback keyword detected: 'contacterai ma banque'\nFraud score: 15 (LOW â€” S9 single mention)\nAmount: â‚¬9.99",author_id:39001,public:false,created_at:"2026-02-23 10:23"}
   ]},
  // L3: renewal_date_inquiry (ES)
  {id:125504, subject:"Â¿CuÃ¡ndo se renueva mi suscripciÃ³n?", description:"Quiero saber cuÃ¡ndo es mi prÃ³xima fecha de facturaciÃ³n y cuÃ¡nto tiempo me queda de VIP.", status:"solved", priority:"normal", channel:"ì±—ë´‡", level:"L3", category:"Subscription", tags:["l3","subscription","renewal_date_inquiry","self_service","language__es","sentiment__neutral"], created_at:"2026-02-23 07:45", updated_at:"2026-02-23 07:46",
   comments:[
     {id:10,body:"Hola, quiero saber cuÃ¡ndo es mi prÃ³xima fecha de facturaciÃ³n. Â¿CuÃ¡nto tiempo me queda de VIP?",author_id:38004,public:true,created_at:"2026-02-23 07:45"},
     {id:11,body:"Â¡Hola! Puede verificar su fecha de renovaciÃ³n siguiendo estos pasos:\n\n1. Inicie sesiÃ³n en es.toomics.com\n2. Vaya a Mi PÃ¡gina â†’ GestiÃ³n de SuscripciÃ³n\n3. Su prÃ³xima fecha de facturaciÃ³n y el estado de su suscripciÃ³n se mostrarÃ¡n ahÃ­\n\nSi no ve informaciÃ³n de suscripciÃ³n, es posible que ya haya sido cancelada o haya expirado.\n\nAtentamente,\nEquipo de Soporte Toomics",author_id:39001,public:true,created_at:"2026-02-23 07:46"},
     {id:12,body:"[BOT] Intent: renewal_date_inquiry (confidence: 0.98)\nLevel: L3 â€” Self-service flow\nMarket: ES | Sentiment: neutral\nResolution: Auto-resolved",author_id:39001,public:false,created_at:"2026-02-23 07:46"}
   ]},
  // L3: vip_not_working (EN) â€” ë„ë©”ì¸ í˜¼ë™
  {id:125505, subject:"Paid for VIP but can't access premium chapters", description:"I bought VIP on the English site but when I go to fr.toomics.com I can't read anything.", status:"solved", priority:"normal", channel:"ì±—ë´‡", level:"L3", category:"Subscription", tags:["l3","subscription","vip_not_working","domain_confusion","language__en","sentiment__confused"], created_at:"2026-02-22 22:30", updated_at:"2026-02-22 22:32",
   comments:[
     {id:13,body:"I paid for VIP membership but I can't access any premium chapters. When I click on a chapter it says I need to subscribe. I already paid! What's going on?",author_id:38005,public:true,created_at:"2026-02-22 22:30"},
     {id:14,body:"We understand your confusion. Could you let us know which domain you're trying to access? Toomics VIP is domain-specific:\n\nâ€¢ VIP membership is valid only on the domain where it was purchased\nâ€¢ Each language domain (en, fr, de, es, pt, etc.) operates independently\nâ€¢ A VIP purchased on en.toomics.com cannot be used on fr.toomics.com\n\nPlease log in to the domain where you originally purchased VIP to access your content.\n\nBest regards,\nToomics Support Team",author_id:39001,public:true,created_at:"2026-02-22 22:31"},
     {id:15,body:"Oh I see, I was on the French site. Thanks that worked!",author_id:38005,public:true,created_at:"2026-02-22 22:32"},
     {id:16,body:"[BOT] Intent: vip_not_working â†’ domain_confusion (confidence: 0.91)\nLevel: L3 â€” Self-service (domain guide)\nMarket: EN | Sentiment: confused â†’ resolved\nResolution: Customer confirmed fix",author_id:39001,public:false,created_at:"2026-02-22 22:32"}
   ]},
  // L3: cancel_subscription (DE) â€” ë…ì¼ì–´
  {id:125506, subject:"Abo kÃ¼ndigen bitte", description:"Ich mÃ¶chte mein monatliches Abo sofort kÃ¼ndigen.", status:"solved", priority:"normal", channel:"ì±—ë´‡", level:"L3", category:"Subscription", tags:["l3","subscription","cancel_subscription","self_service","language__de","sentiment__neutral"], created_at:"2026-02-23 08:05", updated_at:"2026-02-23 08:06",
   comments:[
     {id:17,body:"Ich mÃ¶chte mein monatliches Abo sofort kÃ¼ndigen. Wie geht das?",author_id:38006,public:true,created_at:"2026-02-23 08:05"},
     {id:18,body:"Wir verstehen, dass Sie Ihr Abonnement kÃ¼ndigen mÃ¶chten. So kÃ¶nnen Sie es tun:\n\n1. Melden Sie sich bei de.toomics.com an\n2. Gehen Sie zu Meine Seite â†’ Abonnementverwaltung\n3. Klicken Sie auf 'Abonnement kÃ¼ndigen'\n4. BestÃ¤tigen Sie die KÃ¼ndigung\n\nIhr VIP-Zugang bleibt bis zum Ende des aktuellen Abrechnungszeitraums aktiv. Es werden keine weiteren GebÃ¼hren erhoben.\n\nMit freundlichen GrÃ¼ÃŸen,\nToomics Support Team",author_id:39001,public:true,created_at:"2026-02-23 08:06"},
     {id:19,body:"[BOT] Intent: cancel_subscription (confidence: 0.99)\nLevel: L3 â€” Self-service flow\nMarket: DE | Sentiment: neutral\nResolution: Auto-resolved",author_id:39001,public:false,created_at:"2026-02-23 08:06"}
   ]},
  // L2: auto_renewal (PT) â€” ë¸Œë¼ì§ˆ CDC ì–¸ê¸‰
  {id:125507, subject:"Cobrado sem autorizaÃ§Ã£o â€” renovaÃ§Ã£o automÃ¡tica", description:"Fui cobrado R$39,90 sem meu consentimento. Exijo reembolso conforme CDC.", status:"open", priority:"high", channel:"ì›¹", level:"L2", category:"Subscription", tags:["l2","subscription","auto_renewal_complaint","cdc","language__pt","sentiment__angry"], created_at:"2026-02-23 03:15", updated_at:"2026-02-23 05:00",
   comments:[
     {id:20,body:"Fui cobrado R$39,90 no meu cartÃ£o sem meu consentimento. Nunca autorizei renovaÃ§Ã£o automÃ¡tica. Conforme o CÃ³digo de Defesa do Consumidor, exijo reembolso integral em atÃ© 7 dias. Se nÃ£o resolver, vou ao Procon.",author_id:38007,public:true,created_at:"2026-02-23 03:15"},
     {id:21,body:"Entendemos sua preocupaÃ§Ã£o e pedimos desculpas pelo inconveniente.\n\nSua solicitaÃ§Ã£o de reembolso foi encaminhada Ã  nossa equipe de faturamento para anÃ¡lise. Respeitamos integralmente os direitos do consumidor brasileiro.\n\nVocÃª receberÃ¡ uma resposta em atÃ© 24-48 horas.\n\nAtenciosamente,\nEquipe de Suporte Toomics",author_id:39001,public:true,created_at:"2026-02-23 03:16"},
     {id:22,body:"[BOT] Intent: auto_renewal_complaint (confidence: 0.95)\nLevel: L2 â€” Escalated (legal reference)\nMarket: PT | Sentiment: angry\nâš ï¸ Legal keyword: 'CDC', 'Procon'\nBrazilian Consumer Defense Code invoked\nAmount: R$39.90",author_id:39001,public:false,created_at:"2026-02-23 03:16"}
   ]},
  // L3: cancel (JP)
  {id:125508, subject:"ã‚µãƒ–ã‚¹ã‚¯ãƒªãƒ—ã‚·ãƒ§ãƒ³ã‚’è§£ç´„ã—ãŸã„", description:"æœˆé¡ãƒ—ãƒ©ãƒ³ã‚’è§£ç´„ã—ãŸã„ã§ã™ã€‚æ‰‹é †ã‚’æ•™ãˆã¦ãã ã•ã„ã€‚", status:"solved", priority:"normal", channel:"ì±—ë´‡", level:"L3", category:"Subscription", tags:["l3","subscription","cancel_subscription","self_service","language__jp","sentiment__neutral"], created_at:"2026-02-23 02:10", updated_at:"2026-02-23 02:11",
   comments:[
     {id:23,body:"æœˆé¡ãƒ—ãƒ©ãƒ³ã‚’è§£ç´„ã—ãŸã„ã®ã§ã™ãŒã€æ‰‹é †ã‚’æ•™ãˆã¦ã„ãŸã ã‘ã¾ã™ã‹ï¼Ÿ",author_id:38008,public:true,created_at:"2026-02-23 02:10"},
     {id:24,body:"è§£ç´„ã®ã”å¸Œæœ›ã‚’æ‰¿ã‚Šã¾ã—ãŸã€‚ä»¥ä¸‹ã®æ‰‹é †ã§ãŠæ‰‹ç¶šãã„ãŸã ã‘ã¾ã™ã€‚\n\n1. jp.toomics.com ã«ãƒ­ã‚°ã‚¤ãƒ³\n2. ãƒã‚¤ãƒšãƒ¼ã‚¸ â†’ è³¼èª­ç®¡ç†\n3. ã€Œè³¼èª­è§£ç´„ã€ã‚’ã‚¯ãƒªãƒƒã‚¯\n4. è§£ç´„ã‚’ç¢ºèª\n\nç¾åœ¨ã®è«‹æ±‚æœŸé–“ã®çµ‚äº†ã¾ã§ VIP ã‚¢ã‚¯ã‚»ã‚¹ã¯ç¶­æŒã•ã‚Œã¾ã™ã€‚ä»Šå¾Œã®è«‹æ±‚ã¯ç™ºç”Ÿã„ãŸã—ã¾ã›ã‚“ã€‚\n\nä½•ã‹ã”ä¸æ˜ãªç‚¹ãŒã”ã–ã„ã¾ã—ãŸã‚‰ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ã€‚\n\nToomics ã‚µãƒãƒ¼ãƒˆãƒãƒ¼ãƒ ",author_id:39001,public:true,created_at:"2026-02-23 02:11"},
     {id:25,body:"[BOT] Intent: cancel_subscription (confidence: 0.98)\nLevel: L3 â€” Self-service flow\nMarket: JP | Sentiment: neutral\nResolution: Auto-resolved",author_id:39001,public:false,created_at:"2026-02-23 02:11"}
   ]},
  // L3: cancel (IT)
  {id:125509, subject:"Voglio cancellare il mio abbonamento", description:"Per favore cancellate il mio abbonamento mensile.", status:"solved", priority:"normal", channel:"ì±—ë´‡", level:"L3", category:"Subscription", tags:["l3","subscription","cancel_subscription","self_service","language__it","sentiment__neutral"], created_at:"2026-02-22 19:40", updated_at:"2026-02-22 19:41",
   comments:[
     {id:26,body:"Per favore, vorrei cancellare il mio abbonamento mensile. Come posso fare?",author_id:38009,public:true,created_at:"2026-02-22 19:40"},
     {id:27,body:"Comprendiamo la Sua richiesta. Ecco come procedere:\n\n1. Acceda a it.toomics.com\n2. Vada su La Mia Pagina â†’ Gestione Abbonamento\n3. Clicchi su 'Cancella Abbonamento'\n4. Confermi la cancellazione\n\nIl Suo accesso VIP rimarrÃ  attivo fino alla fine del periodo di fatturazione corrente.\n\nCordiali saluti,\nTeam Supporto Toomics",author_id:39001,public:true,created_at:"2026-02-22 19:41"},
     {id:28,body:"[BOT] Intent: cancel_subscription (confidence: 0.97)\nLevel: L3 â€” Self-service flow\nMarket: IT | Sentiment: neutral\nResolution: Auto-resolved",author_id:39001,public:false,created_at:"2026-02-22 19:41"}
   ]},
  // L3: cancel (CN) â€” ì¤‘êµ­ì–´ ë²ˆì²´
  {id:125510, subject:"æˆ‘æƒ³å–æ¶ˆè¨‚é–±", description:"è«‹å¹«æˆ‘å–æ¶ˆæœˆè²»è¨‚é–±ï¼Œè¬è¬ã€‚", status:"solved", priority:"normal", channel:"ì±—ë´‡", level:"L3", category:"Subscription", tags:["l3","subscription","cancel_subscription","self_service","language__cn","sentiment__neutral"], created_at:"2026-02-23 01:30", updated_at:"2026-02-23 01:31",
   comments:[
     {id:29,body:"æ‚¨å¥½ï¼Œè«‹å¹«æˆ‘å–æ¶ˆæœˆè²»è¨‚é–±ï¼Œè¬è¬ã€‚",author_id:38010,public:true,created_at:"2026-02-23 01:30"},
     {id:30,body:"æ‚¨å¥½ï¼Œæ„Ÿè¬æ‚¨çš„è¯ç¹«ã€‚è«‹æŒ‰ç…§ä»¥ä¸‹æ­¥é©Ÿå–æ¶ˆè¨‚é–±ï¼š\n\n1. ç™»å…¥ cn.toomics.com\n2. å‰å¾€ã€Œæˆ‘çš„é é¢ã€â†’ã€Œè¨‚é–±ç®¡ç†ã€\n3. é»æ“Šã€Œå–æ¶ˆè¨‚é–±ã€\n4. ç¢ºèªå–æ¶ˆ\n\næ‚¨çš„ VIP æ¬Šé™å°‡æŒçºŒåˆ°ç•¶å‰è¨ˆè²»æœŸçµæŸã€‚ä¸æœƒå†ç”¢ç”Ÿä»»ä½•è²»ç”¨ã€‚\n\nToomics å®¢æœåœ˜éšŠ æ•¬ä¸Š",author_id:39001,public:true,created_at:"2026-02-23 01:31"},
     {id:31,body:"[BOT] Intent: cancel_subscription (confidence: 0.97)\nLevel: L3 â€” Self-service flow\nMarket: CN | Sentiment: neutral\nResolution: Auto-resolved",author_id:39001,public:false,created_at:"2026-02-23 01:31"}
   ]},
  // L3: cancel (TH)
  {id:125511, subject:"à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸¢à¸à¹€à¸¥à¸´à¸à¸ªà¸¡à¸²à¸Šà¸´à¸", description:"à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸¢à¸à¹€à¸¥à¸´à¸à¹à¸à¹‡à¸à¹€à¸à¸ˆà¸£à¸²à¸¢à¹€à¸”à¸·à¸­à¸™à¸„à¸£à¸±à¸š", status:"solved", priority:"normal", channel:"ì±—ë´‡", level:"L3", category:"Subscription", tags:["l3","subscription","cancel_subscription","self_service","language__th","sentiment__neutral"], created_at:"2026-02-23 05:55", updated_at:"2026-02-23 05:56",
   comments:[
     {id:32,body:"à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸¢à¸à¹€à¸¥à¸´à¸à¹à¸à¹‡à¸à¹€à¸à¸ˆà¸£à¸²à¸¢à¹€à¸”à¸·à¸­à¸™à¸„à¸£à¸±à¸š à¸—à¸³à¸¢à¸±à¸‡à¹„à¸‡à¸„à¸£à¸±à¸š",author_id:38011,public:true,created_at:"2026-02-23 05:55"},
     {id:33,body:"à¸ªà¸§à¸±à¸ªà¸”à¸µà¸„à¸£à¸±à¸š à¹€à¸‚à¹‰à¸²à¹ƒà¸ˆà¸„à¸£à¸±à¸š à¸ªà¸²à¸¡à¸²à¸£à¸–à¸¢à¸à¹€à¸¥à¸´à¸à¹„à¸”à¹‰à¸•à¸²à¸¡à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸”à¸±à¸‡à¸™à¸µà¹‰à¸„à¸£à¸±à¸š:\n\n1. à¹€à¸‚à¹‰à¸²à¸ªà¸¹à¹ˆà¸£à¸°à¸šà¸šà¸—à¸µà¹ˆ th.toomics.com\n2. à¹„à¸›à¸—à¸µà¹ˆ à¸«à¸™à¹‰à¸²à¸‚à¸­à¸‡à¸‰à¸±à¸™ â†’ à¸ˆà¸±à¸”à¸à¸²à¸£à¸ªà¸¡à¸²à¸Šà¸´à¸\n3. à¸„à¸¥à¸´à¸ 'à¸¢à¸à¹€à¸¥à¸´à¸à¸ªà¸¡à¸²à¸Šà¸´à¸'\n4. à¸¢à¸·à¸™à¸¢à¸±à¸™à¸à¸²à¸£à¸¢à¸à¹€à¸¥à¸´à¸\n\nà¸ªà¸´à¸—à¸˜à¸´à¹Œ VIP à¸ˆà¸°à¸¢à¸±à¸‡à¹ƒà¸Šà¹‰à¸‡à¸²à¸™à¹„à¸”à¹‰à¸ˆà¸™à¸–à¸¶à¸‡à¸ªà¸´à¹‰à¸™à¸ªà¸¸à¸”à¸£à¸­à¸šà¸šà¸´à¸¥à¸›à¸±à¸ˆà¸ˆà¸¸à¸šà¸±à¸™à¸„à¸£à¸±à¸š\n\nà¸—à¸µà¸¡à¸‹à¸±à¸à¸à¸­à¸£à¹Œà¸• Toomics",author_id:39001,public:true,created_at:"2026-02-23 05:56"},
     {id:34,body:"[BOT] Intent: cancel_subscription (confidence: 0.96)\nLevel: L3 â€” Self-service flow\nMarket: TH | Sentiment: neutral\nResolution: Auto-resolved",author_id:39001,public:false,created_at:"2026-02-23 05:56"}
   ]},
  // L2: charged after cancel (EN)
  {id:125512, subject:"Still being charged after cancellation!", description:"I cancelled my subscription 3 weeks ago but I got charged $14.99 again today!", status:"open", priority:"high", channel:"ì›¹", level:"L2", category:"Subscription", tags:["l2","subscription","cancel_and_refund","language__en","sentiment__angry"], created_at:"2026-02-23 11:40", updated_at:"2026-02-23 11:42",
   comments:[
     {id:35,body:"This is ridiculous! I cancelled my subscription 3 weeks ago and I just got charged $14.99 AGAIN today. This is the SECOND time after cancellation. I want my money back NOW.",author_id:38012,public:true,created_at:"2026-02-23 11:40"},
     {id:36,body:"We sincerely apologize for this repeated charge after your cancellation. This should not have happened.\n\nWe've flagged this as a priority case and escalated it to our billing team immediately. A refund will be reviewed within 24 hours.\n\nBest regards,\nToomics Support Team",author_id:39001,public:true,created_at:"2026-02-23 11:41"},
     {id:37,body:"[BOT] Intent: cancel_and_refund (confidence: 0.96)\nLevel: L2 â€” Priority escalation\nMarket: EN | Sentiment: angry (repeated issue)\nAmount: $14.99 | Repeat billing after cancel Ã—2\nâš ï¸ High churn risk",author_id:39001,public:false,created_at:"2026-02-23 11:41"}
   ]},

  // â”€â”€ Refund (25%) â”€â”€ 6 tickets â”€â”€
  // L2: simple_refund (EN)
  {id:125513, subject:"I want a refund for my 6-month subscription", description:"I bought the 6-month plan by mistake. I meant to buy 1 month.", status:"pending", priority:"high", channel:"ì±—ë´‡", level:"L2", category:"Refund", tags:["l2","refund","simple_refund","subscription_6m","language__en","sentiment__frustrated"], created_at:"2026-02-23 06:20", updated_at:"2026-02-23 08:00",
   comments:[
     {id:38,body:"I accidentally purchased the 6-month subscription ($49.99) instead of the monthly plan ($9.99). I just bought it 20 minutes ago. Can I get a refund for the difference or a full refund? I haven't read anything yet.",author_id:38013,public:true,created_at:"2026-02-23 06:20"},
     {id:39,body:"We understand this was an accidental purchase, and we're sorry for the inconvenience.\n\nSince you purchased this recently and haven't accessed any content, we've submitted your refund request to our billing team for review. They will evaluate the refund eligibility.\n\nYou should hear back within 24-48 hours.\n\nBest regards,\nToomics Support Team",author_id:39001,public:true,created_at:"2026-02-23 06:21"},
     {id:40,body:"[BOT] Intent: simple_refund (confidence: 0.95)\nLevel: L2 â€” Refund eligibility review\nMarket: EN | Sentiment: frustrated\nPlan: 6-month ($49.99) | Purchased: 20min ago\nContent accessed: None (per customer claim â€” needs verification)\nRefund type: Full refund candidate",author_id:39001,public:false,created_at:"2026-02-23 06:21"}
   ]},
  // L1: unauthorized_charge (EN) â€” Fraud HIGH
  {id:125514, subject:"Unauthorized charge â€” I never signed up for this", description:"$29.99 charge from Toomics on my Visa. Never heard of this site. Filing chargeback.", status:"new", priority:"urgent", channel:"ì›¹", level:"L1", category:"Refund", tags:["l1","refund","unauthorized_charge","fraud_high","chargeback_risk","language__en","sentiment__angry"], created_at:"2026-02-23 11:05", updated_at:"2026-02-23 11:05",
   comments:[
     {id:41,body:"I just noticed a charge of $29.99 from 'TOOMICS GLOBAL' on my Visa ending in 7291. I have NEVER heard of this website and I certainly did NOT sign up for anything. This is fraud. I need an immediate refund or I will file a chargeback with my bank TODAY.",author_id:38014,public:true,created_at:"2026-02-23 11:05"},
     {id:42,body:"[BOT] ğŸ”´ FRAUD DETECTION â€” Score: 55/100 (HIGH)\n\nRed Flags triggered:\nâ€¢ C1: Unauthorized claim â€” 'never signed up' (40pts) [needs backend verification]\nâ€¢ S9: Chargeback threat â€” 'file a chargeback with my bank' (15pts)\n\nAction: L1 immediate escalation\nCard: Visa ****7291 | Amount: $29.99\nNote: Must verify account activity before responding to fraud claim. Customer may have content viewing history.",author_id:39001,public:false,created_at:"2026-02-23 11:05"}
   ]},
  // L1: child_purchase (EN) â€” ë¯¸ì„±ë…„ì ê²°ì œ
  {id:125515, subject:"My child purchased coins without permission", description:"My 12-year-old son used my PayPal to buy 500 coins ($49.99).", status:"new", priority:"urgent", channel:"ì›¹", level:"L1", category:"Refund", tags:["l1","refund","child_purchase","minor","unauthorized","language__en","sentiment__distressed"], created_at:"2026-02-23 11:50", updated_at:"2026-02-23 11:50",
   comments:[
     {id:43,body:"My 12-year-old son somehow got into my PayPal and purchased 500 coins ($49.99) on Toomics without my knowledge. He is a MINOR and should not even be allowed to use this service. I need a full refund immediately. He has accessed adult content which is extremely concerning.",author_id:38015,public:true,created_at:"2026-02-23 11:50"},
     {id:44,body:"[BOT] ğŸ”´ FRAUD DETECTION â€” Score: 55/100 (HIGH)\n\nRed Flags triggered:\nâ€¢ C1: Unauthorized claim â€” minor used account (40pts)\nâ€¢ S9: Implied dispute risk (15pts)\n\nAdditional concerns:\nâ€¢ Minor (12yo) accessing platform\nâ€¢ Adult content access claim\nâ€¢ PayPal unauthorized use\n\nAction: L1 immediate escalation â€” requires human review\nPayPal | Amount: $49.99 (500 coins)\nâš ï¸ Legal/compliance review may be needed (minor + adult content)",author_id:39001,public:false,created_at:"2026-02-23 11:50"}
   ]},
  // L3: ios_refund (EN) â€” Apple ë¦¬ë””ë ‰íŠ¸
  {id:125516, subject:"How do I get a refund for my iOS purchase?", description:"I bought coins through the iPhone app and want a refund.", status:"solved", priority:"normal", channel:"ì±—ë´‡", level:"L3", category:"Refund", tags:["l3","refund","ios_refund","apple","self_service","language__en","sentiment__neutral"], created_at:"2026-02-22 18:40", updated_at:"2026-02-22 18:41",
   comments:[
     {id:45,body:"I bought 200 coins through the Toomics iPhone app yesterday. Can I get a refund? I changed my mind.",author_id:38016,public:true,created_at:"2026-02-22 18:40"},
     {id:46,body:"Since your purchase was made through the iOS app, refunds are handled directly by Apple. Here's how to request one:\n\n1. Visit https://reportaproblem.apple.com\n2. Sign in with your Apple ID\n3. Find the Toomics charge in your purchase history\n4. Select 'Request a Refund' and choose your reason\n\nApple typically processes refund requests within 48 hours. You can also manage subscriptions in iPhone Settings â†’ your name â†’ Subscriptions.\n\nBest regards,\nToomics Support Team",author_id:39001,public:true,created_at:"2026-02-22 18:41"},
     {id:47,body:"[BOT] Intent: ios_refund (confidence: 0.99)\nLevel: L3 â€” Self-service (Apple redirect)\nMarket: EN | Sentiment: neutral\nResolution: Auto-resolved â€” Apple refund process guide provided",author_id:39001,public:false,created_at:"2026-02-22 18:41"}
   ]},
  // L3: refund_status (FR)
  {id:125517, subject:"Quand vais-je recevoir mon remboursement?", description:"J'ai demandÃ© un remboursement il y a 5 jours. Toujours rien.", status:"solved", priority:"normal", channel:"ì±—ë´‡", level:"L3", category:"Refund", tags:["l3","refund","refund_status","language__fr","sentiment__impatient"], created_at:"2026-02-23 09:30", updated_at:"2026-02-23 09:31",
   comments:[
     {id:48,body:"J'ai demandÃ© un remboursement il y a 5 jours via PayPal. Je n'ai toujours rien reÃ§u. Quand est-ce que Ã§a sera traitÃ©?",author_id:38017,public:true,created_at:"2026-02-23 09:30"},
     {id:49,body:"Nous comprenons votre impatience. Votre remboursement est en cours de traitement.\n\nLes dÃ©lais de remboursement dÃ©pendent de votre mode de paiement:\nâ€¢ PayPal: 3-5 jours ouvrÃ©s\nâ€¢ Carte de crÃ©dit: 5-10 jours ouvrÃ©s\n\nPuisque vous avez utilisÃ© PayPal, le remboursement devrait apparaÃ®tre dans les prochains jours. Si vous ne l'avez pas reÃ§u aprÃ¨s 7 jours ouvrÃ©s, n'hÃ©sitez pas Ã  nous recontacter.\n\nCordialement,\nL'Ã©quipe Support Toomics",author_id:39001,public:true,created_at:"2026-02-23 09:31"},
     {id:50,body:"[BOT] Intent: refund_status (confidence: 0.97)\nLevel: L3 â€” Self-service (timeline info)\nMarket: FR | Sentiment: impatient\nPayment: PayPal | Refund requested: 5 days ago\nResolution: Auto-resolved â€” timeline provided",author_id:39001,public:false,created_at:"2026-02-23 09:31"}
   ]},
  // L2: partial_refund (ES)
  {id:125518, subject:"Solicito reembolso parcial â€” solo usÃ© 3 dÃ­as", description:"ComprÃ© plan mensual pero quiero cancelar despuÃ©s de 3 dÃ­as.", status:"pending", priority:"normal", channel:"ì±—ë´‡", level:"L2", category:"Refund", tags:["l2","refund","partial_refund","language__es","sentiment__neutral"], created_at:"2026-02-23 08:50", updated_at:"2026-02-23 09:10",
   comments:[
     {id:51,body:"ComprÃ© el plan mensual hace 3 dÃ­as ($9.99). Quisiera cancelar y recibir un reembolso parcial por los dÃ­as restantes. Solo leÃ­ 2 capÃ­tulos.",author_id:38018,public:true,created_at:"2026-02-23 08:50"},
     {id:52,body:"Entendemos su solicitud. Hemos enviado su caso al equipo de facturaciÃ³n para evaluar un posible reembolso parcial basado en el uso.\n\nLe informaremos del resultado en un plazo de 24-48 horas.\n\nAtentamente,\nEquipo de Soporte Toomics",author_id:39001,public:true,created_at:"2026-02-23 08:51"},
     {id:53,body:"[BOT] Intent: partial_refund (confidence: 0.93)\nLevel: L2 â€” Escalated (refund eligibility)\nMarket: ES | Sentiment: neutral\nPlan: Monthly ($9.99) | Days used: 3/30\nContent accessed: 2 chapters (per customer)\nRefund type: Partial (pro-rata candidate)",author_id:39001,public:false,created_at:"2026-02-23 08:51"}
   ]},

  // â”€â”€ Account (13%) â”€â”€ 3 tickets â”€â”€
  // L3: password_reset (FR)
  {id:125519, subject:"Mot de passe oubliÃ© â€” le lien ne fonctionne pas", description:"J'ai oubliÃ© mon mot de passe. Le lien de rÃ©initialisation ne fonctionne pas.", status:"solved", priority:"normal", channel:"ì±—ë´‡", level:"L3", category:"Account", tags:["l3","account","password_reset","self_service","language__fr","sentiment__frustrated"], created_at:"2026-02-23 08:22", updated_at:"2026-02-23 08:24",
   comments:[
     {id:54,body:"J'ai oubliÃ© mon mot de passe et quand je clique sur 'mot de passe oubliÃ©', le lien de rÃ©initialisation ne fonctionne pas. Ã‡a fait 3 fois que j'essaie.",author_id:38019,public:true,created_at:"2026-02-23 08:22"},
     {id:55,body:"Nous comprenons que cette situation est frustrante. Voici comment rÃ©initialiser votre mot de passe:\n\n1. Allez sur fr.toomics.com\n2. Cliquez sur 'Connexion' â†’ 'Mot de passe oubliÃ©?'\n3. Saisissez votre adresse e-mail enregistrÃ©e\n4. VÃ©rifiez votre boÃ®te de rÃ©ception (et le dossier spam/courrier indÃ©sirable)\n5. Cliquez sur le lien et dÃ©finissez un nouveau mot de passe\n\nLe lien de rÃ©initialisation est valide pendant 24 heures. Si vous ne recevez pas l'e-mail, veuillez vÃ©rifier que vous utilisez la bonne adresse.\n\nCordialement,\nL'Ã©quipe Support Toomics",author_id:39001,public:true,created_at:"2026-02-23 08:23"},
     {id:56,body:"Merci, j'avais vÃ©rifiÃ© les spams mais pas avec la bonne adresse. C'est rÃ©solu!",author_id:38019,public:true,created_at:"2026-02-23 08:24"},
     {id:57,body:"[BOT] Intent: password_reset (confidence: 0.98)\nLevel: L3 â€” Self-service flow\nMarket: FR | Sentiment: frustrated â†’ resolved\nResolution: Customer confirmed fix (wrong email used)",author_id:39001,public:false,created_at:"2026-02-23 08:24"}
   ]},
  // L1: account_deletion + GDPR (DE)
  {id:125520, subject:"LÃ¶schung meines Kontos gemÃ¤ÃŸ DSGVO Art. 17", description:"Ich fordere die vollstÃ¤ndige LÃ¶schung meiner personenbezogenen Daten.", status:"new", priority:"high", channel:"ì›¹", level:"L1", category:"Account", tags:["l1","account","account_deletion","gdpr","dsgvo","language__de","sentiment__formal"], created_at:"2026-02-23 10:00", updated_at:"2026-02-23 10:00",
   comments:[
     {id:58,body:"Hiermit fordere ich gemÃ¤ÃŸ Artikel 17 der Datenschutz-Grundverordnung (DSGVO) die vollstÃ¤ndige LÃ¶schung meines Kontos und aller damit verbundenen personenbezogenen Daten innerhalb von 30 Tagen.\n\nBitte bestÃ¤tigen Sie den Eingang und den voraussichtlichen Zeitrahmen der LÃ¶schung.",author_id:38020,public:true,created_at:"2026-02-23 10:00"},
     {id:59,body:"[BOT] Intent: account_deletion (confidence: 0.99)\nLevel: L1 â€” Immediate escalation\nMarket: DE | Sentiment: formal\nâš ï¸ Legal keyword: 'DSGVO', 'Artikel 17', 'Datenschutz-Grundverordnung'\nGDPR Art.17 Right to Erasure â€” 30-day compliance deadline\nAction: Requires human processing â€” legal compliance mandatory",author_id:39001,public:false,created_at:"2026-02-23 10:00"}
   ]},
  // L2: email_change (EN)
  {id:125521, subject:"Need to change my account email address", description:"I need to update my email because I lost access to my old one.", status:"open", priority:"normal", channel:"ì±—ë´‡", level:"L2", category:"Account", tags:["l2","account","email_change","language__en","sentiment__neutral"], created_at:"2026-02-23 07:15", updated_at:"2026-02-23 07:30",
   comments:[
     {id:60,body:"I need to change my account email from my old address to a new one. I no longer have access to the old email. My account username is toomicsfan2024.",author_id:38021,public:true,created_at:"2026-02-23 07:15"},
     {id:61,body:"We understand you need to update your email address. For security purposes, email changes require identity verification.\n\nWe've escalated your request to our account team. They will reach out with verification steps to confirm your account ownership.\n\nBest regards,\nToomics Support Team",author_id:39001,public:true,created_at:"2026-02-23 07:16"},
     {id:62,body:"[BOT] Intent: email_change (confidence: 0.97)\nLevel: L2 â€” Escalated (identity verification required)\nMarket: EN | Sentiment: neutral\nUsername provided: toomicsfan2024\nOld email: inaccessible | New email: not yet provided\nSecurity: Identity verification needed before change",author_id:39001,public:false,created_at:"2026-02-23 07:16"}
   ]},

  // â”€â”€ Payment (5%) â”€â”€ 2 tickets â”€â”€
  // L2: coin_issue / payment_not_applied (PT â€” PIX)
  {id:125522, subject:"Paguei via PIX mas os coins nÃ£o apareceram", description:"Fiz pagamento PIX de R$19,90 hÃ¡ 3 dias e nÃ£o recebi os coins.", status:"open", priority:"high", channel:"ì±—ë´‡", level:"L2", category:"Payment", tags:["l2","payment","payment_not_applied","pix","language__pt","sentiment__frustrated"], created_at:"2026-02-23 04:40", updated_at:"2026-02-23 06:00",
   comments:[
     {id:63,body:"Fiz um pagamento via PIX de R$19,90 hÃ¡ 3 dias para comprar 100 coins. O dinheiro saiu da minha conta mas os coins nÃ£o apareceram no meu perfil. O comprovante PIX mostra como concluÃ­do.",author_id:38022,public:true,created_at:"2026-02-23 04:40"},
     {id:64,body:"Pedimos desculpas pelo inconveniente. Pagamentos via PIX podem levar atÃ© 10 dias Ãºteis para serem processados.\n\nNo entanto, como jÃ¡ se passaram 3 dias, encaminhamos seu caso para nossa equipe de pagamentos para verificaÃ§Ã£o prioritÃ¡ria.\n\nAtenciosamente,\nEquipe de Suporte Toomics",author_id:39001,public:true,created_at:"2026-02-23 04:41"},
     {id:65,body:"[BOT] Intent: payment_not_applied (confidence: 0.95)\nLevel: L2 â€” Escalated (payment verification)\nMarket: PT | Sentiment: frustrated\nPayment: PIX | Amount: R$19.90 (100 coins)\nTimeline: 3 days since payment\nNote: PIX normal processing up to 10 business days, but customer escalation warranted",author_id:39001,public:false,created_at:"2026-02-23 04:41"}
   ]},
  // L1: double_charge (EN)
  {id:125523, subject:"Charged TWICE for the same subscription!", description:"I was charged $9.99 twice on Feb 22. Two identical charges on my Mastercard.", status:"new", priority:"urgent", channel:"ì›¹", level:"L1", category:"Payment", tags:["l1","payment","double_charge","language__en","sentiment__angry"], created_at:"2026-02-23 10:55", updated_at:"2026-02-23 10:55",
   comments:[
     {id:66,body:"I was charged $9.99 TWICE on February 22nd for the same monthly subscription. Two identical charges on my Mastercard ending in 3156. This is unacceptable. I want one of these charges refunded immediately.",author_id:38023,public:true,created_at:"2026-02-23 10:55"},
     {id:67,body:"[BOT] Intent: double_charge (confidence: 0.99)\nLevel: L1 â€” Immediate escalation\nMarket: EN | Sentiment: angry\nCard: Mastercard ****3156\nAmount: $9.99 Ã— 2 (Feb 22)\nAction: Duplicate charge verification + refund processing needed\nâš ï¸ High priority â€” billing system check required",author_id:39001,public:false,created_at:"2026-02-23 10:55"}
   ]},

  // â”€â”€ Content (4%) â”€â”€ 1 ticket â”€â”€
  // L2: content_error (TH)
  {id:125524, subject:"à¸‹à¸·à¹‰à¸­à¸•à¸­à¸™à¹à¸¥à¹‰à¸§à¹à¸•à¹ˆà¸­à¹ˆà¸²à¸™à¹„à¸¡à¹ˆà¹„à¸”à¹‰ à¸‚à¸¶à¹‰à¸™à¸§à¹ˆà¸²à¸•à¹‰à¸­à¸‡à¸‹à¸·à¹‰à¸­à¹ƒà¸«à¸¡à¹ˆ", description:"à¸‹à¸·à¹‰à¸­à¸•à¸­à¸™à¸—à¸µà¹ˆ 45 à¸‚à¸­à¸‡ Solo Leveling à¹„à¸›à¹à¸¥à¹‰à¸§ à¹à¸•à¹ˆà¹€à¸›à¸´à¸”à¸­à¹ˆà¸²à¸™à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸„à¸£à¸±à¸š", status:"open", priority:"normal", channel:"ì±—ë´‡", level:"L2", category:"Content", tags:["l2","content","content_error","purchased_chapter","language__th","sentiment__frustrated"], created_at:"2026-02-23 05:40", updated_at:"2026-02-23 07:00",
   comments:[
     {id:68,body:"à¸‹à¸·à¹‰à¸­à¸•à¸­à¸™à¸—à¸µà¹ˆ 45 à¸‚à¸­à¸‡ Solo Leveling à¹„à¸›à¹à¸¥à¹‰à¸§ à¸ˆà¹ˆà¸²à¸¢ 3 coins à¹à¸•à¹ˆà¸à¸­à¸à¸”à¹€à¸‚à¹‰à¸²à¸­à¹ˆà¸²à¸™ à¸‚à¸¶à¹‰à¸™à¸§à¹ˆà¸²à¸•à¹‰à¸­à¸‡à¸‹à¸·à¹‰à¸­à¹ƒà¸«à¸¡à¹ˆà¸„à¸£à¸±à¸š à¸¥à¸­à¸‡à¸¥à¹‡à¸­à¸à¹€à¸­à¹‰à¸²à¸—à¹Œà¹à¸¥à¹‰à¸§à¸¥à¹‡à¸­à¸à¸­à¸´à¸™à¹ƒà¸«à¸¡à¹ˆà¸à¹‡à¸¢à¸±à¸‡à¹€à¸«à¸¡à¸·à¸­à¸™à¹€à¸”à¸´à¸¡à¸„à¸£à¸±à¸š",author_id:38024,public:true,created_at:"2026-02-23 05:40"},
     {id:69,body:"à¸‚à¸­à¸­à¸ à¸±à¸¢à¹ƒà¸™à¸„à¸§à¸²à¸¡à¹„à¸¡à¹ˆà¸ªà¸°à¸”à¸§à¸à¸„à¸£à¸±à¸š à¸‚à¸­à¹€à¸£à¸µà¸¢à¸™à¸§à¹ˆà¸²à¹€à¸£à¸²à¹„à¸”à¹‰à¸£à¸±à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸‚à¸­à¸‡à¸—à¹ˆà¸²à¸™à¹à¸¥à¹‰à¸§\n\nà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸µà¹ˆà¹€à¸£à¸²à¸šà¸±à¸™à¸—à¸¶à¸à¹„à¸§à¹‰:\nâ€¢ à¹€à¸£à¸·à¹ˆà¸­à¸‡: Solo Leveling à¸•à¸­à¸™à¸—à¸µà¹ˆ 45\nâ€¢ à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢: 3 coins\nâ€¢ à¸­à¸¸à¸›à¸à¸£à¸“à¹Œ: (à¸à¸£à¸¸à¸“à¸²à¹à¸ˆà¹‰à¸‡à¸­à¸¸à¸›à¸à¸£à¸“à¹Œà¸—à¸µà¹ˆà¹ƒà¸Šà¹‰à¸‡à¸²à¸™)\n\nà¹€à¸£à¸²à¹„à¸”à¹‰à¸ªà¹ˆà¸‡à¹€à¸£à¸·à¹ˆà¸­à¸‡à¹„à¸›à¸¢à¸±à¸‡à¸—à¸µà¸¡à¹€à¸—à¸„à¸™à¸´à¸„à¹€à¸à¸·à¹ˆà¸­à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¹à¸¥à¹‰à¸§à¸„à¸£à¸±à¸š à¸ˆà¸°à¹à¸ˆà¹‰à¸‡à¸œà¸¥à¹ƒà¸«à¹‰à¸—à¸£à¸²à¸šà¹‚à¸”à¸¢à¹€à¸£à¹‡à¸§à¸—à¸µà¹ˆà¸ªà¸¸à¸”à¸„à¸£à¸±à¸š\n\nà¸—à¸µà¸¡à¸‹à¸±à¸à¸à¸­à¸£à¹Œà¸• Toomics",author_id:39001,public:true,created_at:"2026-02-23 05:41"},
     {id:70,body:"[BOT] Intent: content_error (confidence: 0.94)\nLevel: L2 â€” Escalated (info collected, tech team)\nMarket: TH | Sentiment: frustrated\nSeries: Solo Leveling | Chapter: 45 | Cost: 3 coins\nIssue: Purchased chapter showing as locked\nTroubleshooting attempted: Re-login (no fix)",author_id:39001,public:false,created_at:"2026-02-23 05:41"}
   ]},

  // â”€â”€ Technical (3%) â”€â”€ 1 ticket â”€â”€
  // L1: bug_report (EN) â€” ê¸°ê¸°+OS í¬í•¨
  {id:125525, subject:"App crashes every time I open a chapter â€” iPhone 15 Pro, iOS 18.3", description:"Crash happens on every chapter. Already reinstalled.", status:"open", priority:"high", channel:"ëª¨ë°”ì¼", level:"L1", category:"Technical", tags:["l1","technical","bug_report","ios","iphone_15_pro","language__en","sentiment__frustrated"], created_at:"2026-02-23 06:18", updated_at:"2026-02-23 08:00",
   comments:[
     {id:71,body:"The app crashes every single time I try to open any chapter. I'm using iPhone 15 Pro with iOS 18.3.1. I've tried:\n- Force closing the app\n- Clearing cache\n- Uninstalling and reinstalling\n- Restarting my phone\n\nNothing works. This started 2 days ago. The app was fine before the last update.",author_id:38025,public:true,created_at:"2026-02-23 06:18"},
     {id:72,body:"We're sorry for this frustrating experience. Thank you for the detailed bug report.\n\nWe've logged this issue with our development team:\nâ€¢ Device: iPhone 15 Pro\nâ€¢ OS: iOS 18.3.1\nâ€¢ Trigger: Chapter open â†’ crash\nâ€¢ Onset: ~2 days ago (post-update)\n\nIn the meantime, you can try accessing your content through the mobile web browser at en.toomics.com. We'll update you when a fix is available.\n\nBest regards,\nToomics Support Team",author_id:39001,public:true,created_at:"2026-02-23 06:19"},
     {id:73,body:"[BOT] Intent: bug_report (confidence: 0.98)\nLevel: L1 â€” Immediate escalation (device+OS bug report)\nMarket: EN | Sentiment: frustrated\nDevice: iPhone 15 Pro | OS: iOS 18.3.1\nPattern: All chapters â†’ crash | Post-update regression\nTroubleshooting: Force close, cache clear, reinstall, restart (all failed)\nDev team notification needed",author_id:39001,public:false,created_at:"2026-02-23 06:19"}
   ]},

  // â”€â”€ Other (2%) â”€â”€ 1 ticket â”€â”€
  // L1: partnership (EN) â€” ë¹„CS ë¬¸ì˜
  {id:125526, subject:"Publishing partnership inquiry â€” webtoon translation", description:"Independent translator looking to partner for French translations.", status:"new", priority:"normal", channel:"ì›¹", level:"L1", category:"Other", tags:["l1","other","partnership","non_cs","language__en","sentiment__neutral"], created_at:"2026-02-23 09:50", updated_at:"2026-02-23 09:50",
   comments:[
     {id:74,body:"Hello,\n\nI am an independent translator specializing in Korean-to-French webtoon translations. I have 5 years of experience working with major platforms including Naver Webtoon.\n\nI would like to discuss a potential partnership opportunity for translating Toomics original titles into French.\n\nPlease let me know the appropriate department to contact.\n\nBest regards,\nMarie Dupont",author_id:38026,public:true,created_at:"2026-02-23 09:50"},
     {id:75,body:"[BOT] Intent: partnership (confidence: 0.96)\nLevel: L1 â€” Immediate escalation (non-CS inquiry)\nMarket: EN | Sentiment: neutral\nType: Business partnership â€” translation services\nAction: Route to appropriate business department\nNote: Not a customer service inquiry â€” automation excluded per policy",author_id:39001,public:false,created_at:"2026-02-23 09:50"}
   ]},

  // â”€â”€ FRAUD ì‹œë‚˜ë¦¬ì˜¤ (êµì°¨) â”€â”€
  // C2+C5: AI-generated legal threat + strategic escalation (EN)
  {id:125527, subject:"Legal demand â€” EU Consumer Rights Directive violation", description:"Formal demand pursuant to Directive 2011/83/EU. 7-day deadline.", status:"new", priority:"urgent", channel:"ì›¹", level:"L1", category:"Refund", tags:["l1","refund","unauthorized_charge","fraud_high","legal_threat","ai_generated","language__en","sentiment__threatening"], created_at:"2026-02-23 12:10", updated_at:"2026-02-23 12:10",
   comments:[
     {id:76,body:"Dear Sir/Madam,\n\nPursuant to Directive 2011/83/EU, Article 14, and in accordance with the applicable consumer protection statutes, I hereby demand the immediate and full reimbursement of the sum of â‚¬29.99 unlawfully deducted from my account.\n\nI reserve the right to pursue all available legal remedies, including but not limited to filing a formal complaint with the European Consumer Centre and initiating proceedings before the competent court, should this matter not be resolved within 7 calendar days.\n\nI expect written confirmation of the refund within 48 hours.\n\nRegards,\nJohnson & Associates\nInternational Consumer Rights Division",author_id:38027,public:true,created_at:"2026-02-23 12:10"},
     {id:77,body:"[BOT] ğŸ”´ FRAUD DETECTION â€” Score: 80/100 (HIGH)\n\nRed Flags triggered:\nâ€¢ C2: AI-Generated Legal Document Pattern (35pts)\n  â€” 'pursuant to', 'Directive 2011/83/EU', 'Article 14', 'hereby demand', '7 calendar days', 'reserve the right', 'legal remedies'\nâ€¢ C3: Fake Legal Representative (35pts)\n  â€” 'Johnson & Associates' â€” generic firm name, no verifiable registration\n  â€” No official domain email (submitted via web form)\nâ€¢ C5: Strategic Escalation Pattern (10pts)\n  â€” Starts at Stage 4 (law firm) without prior communication\n\nAmount: â‚¬29.99\nAction: L1 immediate escalation â€” DO NOT respond with fraud assessment\nâš ï¸ Despite fraud indicators, legal claims must be reviewed by human agent",author_id:39001,public:false,created_at:"2026-02-23 12:10"}
   ]},
  // C4: Contradictory claims across messages (EN) â€” multi-turn
  {id:125528, subject:"I need a refund â€” unauthorized charge", description:"First claimed never signed up, then mentioned specific content read.", status:"open", priority:"urgent", channel:"ì±—ë´‡", level:"L1", category:"Refund", tags:["l1","refund","unauthorized_charge","fraud_high","contradictory","language__en","sentiment__aggressive"], created_at:"2026-02-23 10:30", updated_at:"2026-02-23 10:45",
   comments:[
     {id:78,body:"I never signed up for Toomics. Someone must have used my card. I want a full refund of $9.99 charged on Feb 20.",author_id:38028,public:true,created_at:"2026-02-23 10:30"},
     {id:79,body:"We're sorry to hear about this unexpected charge. To help us investigate, could you please provide:\n\n1. The email address associated with the charge\n2. The last 4 digits of the card used\n3. Any additional details about how you discovered this charge\n\nBest regards,\nToomics Support Team",author_id:39001,public:true,created_at:"2026-02-23 10:31"},
     {id:80,body:"Look, I tried reading some stuff on the site but the quality was terrible. The chapters wouldn't even load properly. I paid $9.99 but the service doesn't work. I want my money back.",author_id:38028,public:true,created_at:"2026-02-23 10:40"},
     {id:81,body:"[BOT] ğŸ”´ FRAUD DETECTION â€” Score: 45â†’70/100 (HIGH)\n\nRed Flags triggered:\nâ€¢ C1: Unauthorized claim with likely content access (40pts)\n  â€” Message 1: 'never signed up', 'someone used my card'\n  â€” Message 2: 'I tried reading some stuff' â€” CONTRADICTS unauthorized claim\nâ€¢ C4: Contradictory Claims (30pts)\n  â€” Msg1: 'never signed up' â†’ Msg2: 'I tried reading' + 'I paid'\n  â€” Shifts from fraud claim to service quality complaint\n\nAmount: $9.99 | Date: Feb 20\nAction: L1 escalation â€” contradictory claims detected\nâš ï¸ Customer changed story â€” agent should verify account activity logs",author_id:39001,public:false,created_at:"2026-02-23 10:41"}
   ]}
];

const MOCK_STATS = { new:5, open:6, pending:3, solved:10, today:18, l1_open:5 };

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// STATE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let currentPage = 1;
let totalTickets = 0;
let perPage = 25;
let autoRefresh = true;
let arTimer = null;
let searchTimer = null;
let activeTicketId = null;

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// INIT
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
document.addEventListener('DOMContentLoaded', () => {
  loadAll();
  scheduleAutoRefresh();
});

function loadAll() {
  loadStats();
  loadTickets();
  setLastUpdated();
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// STATS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function updateKpiFromFiltered(/* unused */) {
  // KPIëŠ” ìƒíƒœ í•„í„°ë¥¼ ì œì™¸í•œ ë‚˜ë¨¸ì§€ í•„í„°(ì–¸ì–´/ì±„ë„/ë ˆë²¨/ì¹´í…Œê³ ë¦¬/ê²€ìƒ‰)ë§Œ ë°˜ì˜
  let base = [...MOCK_TICKETS];
  const c = val('channelFilter'); if (c) { const m={'api':'ì±—ë´‡','web':'ì›¹','chat':'ì±„íŒ…'}; base = base.filter(t => t.channel === (m[c]||c)); }
  const l = val('levelFilter'); if (l) base = base.filter(t => t.level === l);
  const cat = val('categoryFilter'); if (cat) base = base.filter(t => t.category === cat);
  const lang = val('languageFilter'); if (lang) base = base.filter(t => t.tags.some(tag => tag === 'language__'+lang));
  const q = val('searchInput').trim().toLowerCase(); if (q) base = base.filter(t => t.subject.toLowerCase().includes(q) || t.description.toLowerCase().includes(q) || String(t.id).includes(q));
  setText('kv-new', base.filter(t => t.status === 'new').length);
  setText('kv-open', base.filter(t => t.status === 'open').length);
  setText('kv-pending', base.filter(t => t.status === 'pending').length);
  setText('kv-solved', base.filter(t => t.status === 'solved').length);
  setText('kv-l1', base.filter(t => t.level === 'L1' && (t.status === 'open' || t.status === 'new')).length);
}

async function loadStats() {
  if (DEMO_MODE) {
    const d = MOCK_STATS;
    setText('kv-new', d.new); setText('kv-open', d.open);
    setText('kv-pending', d.pending); setText('kv-solved', d.solved);
    setText('kv-l1', d.l1_open);
    return;
  }
  try {
    const res = await fetch('/api/dashboard/stats');
    if (!res.ok) return;
    const d = await res.json();
    setText('kv-new', d.new ?? 'â€“');
    setText('kv-open', d.open ?? 'â€“');
    setText('kv-pending', d.pending ?? 'â€“');
    setText('kv-solved', d.solved ?? 'â€“');
    setText('kv-l1', d.l1_open ?? 'â€“');
  } catch(e) { console.warn('Stats load failed', e); }
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// TICKETS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadTickets(page = 1) {
  currentPage = page;
  const body = document.getElementById('ticketBody');
  body.innerHTML = '<div class="loading-state"><div class="spinner"></div>ë¡œë”© ì¤‘...</div>';
  document.getElementById('paginationBar').style.display = 'none';

  if (DEMO_MODE) {
    let filtered = [...MOCK_TICKETS];
    const s = val('statusFilter'); if (s) filtered = filtered.filter(t => t.status === s);
    const c = val('channelFilter'); if (c) { const m={'api':'ì±—ë´‡','web':'ì›¹','chat':'ì±„íŒ…'}; filtered = filtered.filter(t => t.channel === (m[c]||c)); }
    const l = val('levelFilter'); if (l) filtered = filtered.filter(t => t.level === l);
    const cat = val('categoryFilter'); if (cat) filtered = filtered.filter(t => t.category === cat);
    const lang = val('languageFilter'); if (lang) filtered = filtered.filter(t => t.tags.some(tag => tag === 'language__'+lang));
    const q = val('searchInput').trim().toLowerCase(); if (q) filtered = filtered.filter(t => t.subject.toLowerCase().includes(q) || t.description.toLowerCase().includes(q) || String(t.id).includes(q));
    totalTickets = filtered.length;
    document.getElementById('resultCount').textContent = `ì´ ${totalTickets}ê±´`;
    // KPIë¥¼ í•„í„°ë§ëœ ë°ì´í„° ê¸°ì¤€ìœ¼ë¡œ ì—…ë°ì´íŠ¸
    updateKpiFromFiltered(filtered);
    renderTickets(filtered);
    renderPagination(filtered.length, 1);
    return;
  }

  const params = buildParams(page);
  try {
    const res = await fetch('/api/dashboard/tickets?' + params);
    const d = await res.json();
    if (d.error) {
      body.innerHTML = `<div class="error-banner">âš ï¸ ${d.error}</div>`;
      return;
    }
    totalTickets = d.total || 0;
    document.getElementById('resultCount').textContent = `ì´ ${totalTickets.toLocaleString()}ê±´`;
    renderTickets(d.tickets || []);
    renderPagination(d.total, page);
  } catch(e) {
    body.innerHTML = `<div class="error-banner">âš ï¸ ì—°ê²° ì˜¤ë¥˜: ${e.message}</div>`;
  }
}

function buildParams(page) {
  const p = new URLSearchParams();
  const s = val('statusFilter'); if (s) p.set('status', s);
  const c = val('channelFilter'); if (c) p.set('channel', c);
  const l = val('levelFilter'); if (l) p.set('level', l);
  const cat = val('categoryFilter'); if (cat) p.set('category', cat);
  const q = val('searchInput').trim(); if (q) p.set('q', q);
  p.set('page', page); p.set('per_page', perPage);
  return p.toString();
}

function renderTickets(tickets) {
  const body = document.getElementById('ticketBody');
  if (!tickets.length) {
    body.innerHTML = '<div class="empty-state">ğŸ” í•´ë‹¹í•˜ëŠ” í‹°ì¼“ì´ ì—†ìŠµë‹ˆë‹¤</div>';
    return;
  }
  body.innerHTML = tickets.map(t => {
    const lvl = t.level !== '-' ? `<span class="badge badge-${t.level.toLowerCase()}">${t.level}</span>` : '<span class="badge-dash">â€“</span>';
    const cat = `<span style="font-size: 12px;color:var(--text2);">${t.category}</span>`;
    const sta = `<span class="badge badge-${t.status}">${statusLabel(t.status)}</span>`;
    const levelClass = t.level !== '-' ? `tr-${t.level.toLowerCase()}` : '';
    const activeClass = activeTicketId === t.id ? 'active' : '';
    const lang = getLangFromTags(t.tags);
    return `
      <div class="ticket-row ${levelClass} ${activeClass}" onclick="openTicket(${t.id})" data-id="${t.id}">
        <span class="t-id">#${t.id}</span>
        <span class="t-subject">
          <div class="subj">${esc(t.subject)}</div>
          <div class="desc">${esc(t.description)}</div>
        </span>
        <span class="t-channel" style="font-size: 12px;">${esc(t.channel)}</span>
        <span class="t-lang">${lang}</span>
        <span class="t-level">${lvl}</span>
        <span class="t-cat">${cat}</span>
        <span class="t-status">${sta}</span>
        <span class="t-date">${t.created_at}</span>
        <span><button class="t-open-btn" title="ìƒì„¸ ë³´ê¸°" onclick="event.stopPropagation();openTicket(${t.id})">â€º</button></span>
      </div>`;
  }).join('');
}

function renderPagination(total, page) {
  const bar = document.getElementById('paginationBar');
  const totalPages = Math.ceil(total / perPage);
  if (totalPages <= 1) { bar.style.display = 'none'; return; }
  bar.style.display = 'flex';

  let html = `<button class="page-btn" onclick="loadTickets(${page - 1})" ${page <= 1 ? 'disabled' : ''}>â€¹ ì´ì „</button>`;
  // Show window of pages
  const start = Math.max(1, page - 2), end = Math.min(totalPages, page + 2);
  if (start > 1) html += `<button class="page-btn" onclick="loadTickets(1)">1</button><span class="page-info">â€¦</span>`;
  for (let i = start; i <= end; i++) {
    html += `<button class="page-btn ${i === page ? 'current' : ''}" onclick="loadTickets(${i})">${i}</button>`;
  }
  if (end < totalPages) html += `<span class="page-info">â€¦</span><button class="page-btn" onclick="loadTickets(${totalPages})">${totalPages}</button>`;
  html += `<button class="page-btn" onclick="loadTickets(${page + 1})" ${page >= totalPages ? 'disabled' : ''}>ë‹¤ìŒ â€º</button>`;
  html += `<span class="page-info">${total.toLocaleString()}ê±´ / ${totalPages}í˜ì´ì§€</span>`;
  bar.innerHTML = html;
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// DETAIL SIDEBAR
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function openTicket(id) {
  activeTicketId = id;
  // highlight row
  document.querySelectorAll('.ticket-row').forEach(r => r.classList.remove('active'));
  const row = document.querySelector(`.ticket-row[data-id="${id}"]`);
  if (row) row.classList.add('active');

  const sidebar = document.getElementById('detailSidebar');
  const content = document.getElementById('detailContent');
  const actions = document.getElementById('detailActions');
  sidebar.classList.add('open');
  actions.style.display = 'none';
  content.innerHTML = '<div class="sidebar-loading"><div class="spinner"></div>ë¡œë”© ì¤‘...</div>';

  try {
    let t;
    if (DEMO_MODE) {
      t = MOCK_TICKETS.find(tk => tk.id === id);
      if (!t) { content.innerHTML = '<div class="error-banner">âš ï¸ í‹°ì¼“ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</div>'; return; }
      t = {...t, zendesk_url: `https://toomics.zendesk.com/agent/tickets/${id}`};
    } else {
      const res = await fetch(`/api/dashboard/tickets/${id}`);
      t = await res.json();
      if (t.error) { content.innerHTML = `<div class="error-banner">âš ï¸ ${t.error}</div>`; return; }
    }

    const lvlBadge = t.level !== '-'
      ? `<span class="badge badge-${t.level.toLowerCase()}">${t.level}</span>` : '';
    const staBadge = `<span class="badge badge-${t.status}">${statusLabel(t.status)}</span>`;

    content.innerHTML = `
      <div class="detail-header">
        <div class="dh-title">
          <div class="dh-id">#${t.id} Â· ${t.channel}</div>
          <div class="dh-subject">${esc(t.subject)}</div>
        </div>
        <button class="detail-close" onclick="closeSidebar()">âœ•</button>
      </div>
      <div class="detail-meta">
        ${staBadge}
        ${lvlBadge}
        <div class="meta-chip"><span class="label">ì¹´í…Œê³ ë¦¬</span>${t.category}</div>
        <div class="meta-chip"><span class="label">ì ‘ìˆ˜</span>${t.created_at}</div>
        <div class="meta-chip"><span class="label">ì—…ë°ì´íŠ¸</span>${t.updated_at}</div>
        ${t.tags.filter(tag => !['l1','l2','l3'].includes(tag.toLowerCase())).slice(0,4).map(tag => `<div class="meta-chip">${esc(tag)}</div>`).join('')}
      </div>
      <div class="detail-body">
        <div class="comment-thread">
          ${(t.comments || []).map((c, i) => {
            const isInternal = !c.public;
            const isFraud = isInternal && (c.body.includes('FRAUD') || c.body.includes('ğŸ”´'));
            const isCustomer = c.public && (c.author_id === t.requester_id || c.author_id !== 39001 && i === 0 || (c.author_id && c.author_id >= 38000 && c.author_id < 39000));
            const isBot = c.public && !isCustomer;
            const cls = isFraud ? 'fraud' : isInternal ? 'internal' : isCustomer ? 'customer' : 'bot';
            const icon = isFraud ? 'ğŸš¨ Fraud íƒì§€' : isInternal ? 'ğŸ”’ ë‚´ë¶€ë©”ëª¨' : isCustomer ? 'ğŸ‘¤ ê³ ê°' : 'ğŸ¤– ë´‡';
            const badgeCls = isFraud ? 'c-fraud' : isInternal ? 'c-int' : isCustomer ? 'c-cust' : 'c-bot';
            const badgeTxt = isFraud ? 'Fraud Alert' : isInternal ? 'Internal' : isCustomer ? 'Customer' : 'Bot';
            return `
            <div class="comment-item ${cls}">
              <div class="comment-meta">
                <span class="c-author">${icon}</span>
                <span class="c-badge ${badgeCls}">${badgeTxt}</span>
                <span class="c-time">${c.created_at}</span>
              </div>
              <div class="comment-body">${esc(c.body)}</div>
            </div>`;
          }).join('')}
        </div>
      </div>`;

    document.getElementById('zendeskLink').href = t.zendesk_url;
    actions.style.display = 'flex';
  } catch(e) {
    content.innerHTML = `<div class="error-banner">âš ï¸ ë¡œë“œ ì‹¤íŒ¨: ${e.message}</div>`;
  }
}

function closeSidebar() {
  document.getElementById('detailSidebar').classList.remove('open');
  document.querySelectorAll('.ticket-row').forEach(r => r.classList.remove('active'));
  activeTicketId = null;
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// FILTERS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function applyFilters() { loadTickets(1); }

function setStatusFilter(s) {
  document.getElementById('statusFilter').value = s === 'all' ? '' : s;
  document.querySelectorAll('.kpi-card').forEach(c => c.classList.remove('active'));
  const active = document.querySelector(`.kpi-card[data-s="${s}"]`);
  if (active) active.classList.add('active');
  loadTickets(1);
}

function setLevelFilter(l) {
  document.getElementById('levelFilter').value = l;
  document.querySelectorAll('.kpi-card').forEach(c => c.classList.remove('active'));
  const active = document.querySelector(`.kpi-card[data-s="l1"]`);
  if (active) active.classList.add('active');
  loadTickets(1);
}

function clearFilters() {
  ['statusFilter','channelFilter','levelFilter','categoryFilter','languageFilter'].forEach(id => document.getElementById(id).value = '');
  document.getElementById('searchInput').value = '';
  document.querySelectorAll('.kpi-card').forEach(c => c.classList.remove('active'));
  loadTickets(1);
}

function debounceSearch() {
  clearTimeout(searchTimer);
  searchTimer = setTimeout(() => loadTickets(1), 400);
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// AUTO REFRESH
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function scheduleAutoRefresh() {
  clearInterval(arTimer);
  if (autoRefresh) arTimer = setInterval(loadAll, 60000); // 1ë¶„ë§ˆë‹¤
}
function toggleAutoRefresh() {
  autoRefresh = !autoRefresh;
  const badge = document.getElementById('arBadge');
  badge.textContent = autoRefresh ? 'ğŸ”„ ìë™ê°±ì‹  ON' : 'â¸ ìë™ê°±ì‹  OFF';
  badge.classList.toggle('paused', !autoRefresh);
  scheduleAutoRefresh();
}
function setLastUpdated() {
  const now = new Date();
  document.getElementById('lastUpdated').textContent =
    'ê°±ì‹ : ' + now.toLocaleTimeString('ko-KR', {hour:'2-digit', minute:'2-digit', second:'2-digit'});
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// HELPERS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function statusLabel(s) {
  return {new:'New', open:'Open', pending:'Pending', solved:'Solved', closed:'Closed'}[s] || s;
}
function esc(s) {
  if (!s) return '';
  return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}
function val(id) { return document.getElementById(id)?.value || ''; }
function setText(id, v) { const el = document.getElementById(id); if (el) el.textContent = v; }

const LANG_FLAGS = {en:'ğŸ‡ºğŸ‡¸',fr:'ğŸ‡«ğŸ‡·',es:'ğŸ‡ªğŸ‡¸',pt:'ğŸ‡§ğŸ‡·',de:'ğŸ‡©ğŸ‡ª',th:'ğŸ‡¹ğŸ‡­',jp:'ğŸ‡¯ğŸ‡µ',cn:'ğŸ‡¨ğŸ‡³',it:'ğŸ‡®ğŸ‡¹',kr:'ğŸ‡°ğŸ‡·'};
function getLangFromTags(tags) {
  if (!tags) return '';
  for (const t of tags) {
    if (t.startsWith('language__')) {
      const code = t.replace('language__','');
      return (LANG_FLAGS[code] || '') + ' ' + code.toUpperCase();
    }
  }
  return '';
}

// â”€â”€ Sort â”€â”€
let sortDir = 'desc';
function toggleSort(col) {
  if (col === 'date') {
    sortDir = sortDir === 'desc' ? 'asc' : 'desc';
    const icon = document.getElementById('sortIcon');
    if (icon) icon.textContent = sortDir === 'desc' ? 'â–¼' : 'â–²';
    if (DEMO_MODE) loadTickets(1);
  }
}
// Patch loadTickets for sort â€” insert sort after filter in DEMO_MODE
const _origLoadTickets = loadTickets;
loadTickets = async function(page) {
  await _origLoadTickets(page);
  if (DEMO_MODE && sortDir === 'asc') {
    // Re-sort displayed rows (simple: re-render)
    const body = document.getElementById('ticketBody');
    const rows = [...body.children];
    rows.reverse();
    body.innerHTML = '';
    rows.forEach(r => body.appendChild(r));
  }
};

// â”€â”€ Keyboard â”€â”€
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape') { closeSidebar(); return; }
  const rows = [...document.querySelectorAll('.ticket-row:not(.thead .ticket-row)')];
  if (!rows.length) return;
  const idx = rows.findIndex(r => r.classList.contains('active'));
  if (e.key === 'ArrowDown') {
    e.preventDefault();
    const next = Math.min(idx + 1, rows.length - 1);
    const id = rows[next]?.dataset?.id;
    if (id) openTicket(parseInt(id));
  } else if (e.key === 'ArrowUp') {
    e.preventDefault();
    const prev = Math.max(idx - 1, 0);
    const id = rows[prev]?.dataset?.id;
    if (id) openTicket(parseInt(id));
  }
});

// â”€â”€ KPI today: clear all filters â”€â”€
const _origSetStatusFilter = setStatusFilter;
setStatusFilter = function(s) {
  if (s === 'all') {
    ['statusFilter','channelFilter','levelFilter','categoryFilter','languageFilter'].forEach(id => document.getElementById(id).value = '');
    document.getElementById('searchInput').value = '';
  }
  _origSetStatusFilter(s);
};

// â”€â”€ Demo banner â”€â”€
if (DEMO_MODE) {
  const banner = document.createElement('div');
  banner.className = 'demo-banner';
  banner.innerHTML = 'ğŸ¯ Demo Mode â€” 24 sample tickets';
  document.body.appendChild(banner);
}
</script>
</body>
</html>
